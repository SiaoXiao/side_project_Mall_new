import{D as T,o as x,c as f,e as t,F as D,b,t as n,k,R as I,u as s,S as M,H as d,h as y,i as v,w as h,z as B,T as N,P as F,n as C,U as P,m as R,a as j,V}from"./index-fd57ddf8.js";import{e as E}from"./useNotification-d5b03d5c.js";import{d as U}from"./macaron-40da6c3c.js";const L={class:"w-full"},G={class:"border-b border-[#DDBEA9]"},q={key:0,class:"px-5 py-3 text-sm font-medium tracking-wider text-left text-[#CB997E] whitespace-nowrap"},H={key:0,class:"px-5 py-3 whitespace-nowrap text-text-secondary"},Y={key:0},z=["colspan"],J={__name:"Table",props:{columns:{type:Array,required:!0},data:{type:Array,required:!0},emptyText:{type:String,default:"當前沒有任何資料"},confirmDeleteText:{type:String,default:"確定要執行刪除嗎?"},showActions:{type:Boolean,default:!0}},setup(r){const o=r,c=T(()=>o.columns.length+Number(o.showActions));return(i,e)=>(x(),f("div",M({class:"overflow-x-auto"},i.$attrs),[t("table",L,[t("thead",null,[t("tr",G,[(x(!0),f(D,null,b(r.columns,a=>(x(),f("th",{key:a.key,class:"px-5 py-3 text-sm font-medium tracking-wider text-left text-[#CB997E] whitespace-nowrap"},n(a.label),1))),128)),r.showActions?(x(),f("th",q," 操作 ")):k("",!0)])]),t("tbody",null,[(x(!0),f(D,null,b(r.data,a=>(x(),f("tr",{key:a.id},[(x(!0),f(D,null,b(r.columns,l=>(x(),f("td",{key:l.key,class:"px-5 py-3 whitespace-nowrap text"},[I(i.$slots,`column-${l.key}`,{column:l,record:a,value:a[l.key]},()=>[d(n(a[l.key]),1)])]))),128)),r.showActions?(x(),f("td",H,[I(i.$slots,"actions",{record:a,value:a.Name?a.Name:""})])):k("",!0)]))),128)),r.data.length?k("",!0):(x(),f("tr",Y,[t("td",{colspan:s(c),class:"py-12 text-center text"},n(r.emptyText),9,z)]))])])],16))}},K=r=>{const o=new Date(r*1e3),c=o.getFullYear(),i=String(o.getMonth()+1).padStart(2,"0"),e=String(o.getDate()).padStart(2,"0");return`${c}-${i}-${e}`},Q=r=>{const o=new Date(r*1e3),c=o.getFullYear(),i=String(o.getMonth()+1).padStart(2,"0"),e=String(o.getDate()).padStart(2,"0"),a=String(o.getHours()).padStart(2,"0"),l=String(o.getMinutes()).padStart(2,"0");return`${c}-${i}-${e} ${a}:${l}`},W=t("div",{class:"flex items-center justify-start pb-2 border-b border-[#FFE8D6]"},[t("h3",{class:"text-xl titleText"},"訂單詳細資訊")],-1),X={class:"mt-6 space-y-3"},Z={class:"space-y-2"},tt=t("h4",{class:"text-lg font-medium titleText"},"商品資訊",-1),et={class:"flex border border-[#DDBEA9] p-3 rounded"},st=["src"],ot={class:"flex flex-col items-start justify-center gap-1 px-2"},at={class:"text-lg whitespace-normal titleText"},lt={class:"text font-medium text-red-500 before:content-['NT$'] before:mr-1 before:text-[#252422]"},nt={class:"text before:content-['×'] before:mr-1 before:text-[#252422]"},rt={class:"space-y-2"},ct=t("h4",{class:"text-lg font-medium titleText"},"配送資訊",-1),dt={class:"relative h-[300px] md:h-auto flex flex-col border border-[#DDBEA9] rounded overflow-hidden"},it={class:"absolute top-0 bottom-0 w-full overflow-y-auto md:static md:top-auto md:bottom-auto"},xt={class:"w-full md:w-auto"},ft={class:"flex flex-col px-3 py-2 font-medium text-left text md:flex-row"},ut={class:"text flex-1 text-[#403D39]"},mt={class:"flex flex-col px-3 py-2 font-medium text-left text md:flex-row"},pt={class:"text flex-1 text-[#403D39]"},_t={class:"flex flex-col px-3 py-2 font-medium text-left text md:flex-row"},ht={class:"text flex-1 text-[#403D39]"},yt={class:"flex flex-col px-3 py-2 font-medium text-left text md:flex-row"},vt={class:"text flex-1 text-[#403D39]"},Dt={class:"flex flex-col px-3 py-2 font-medium text-left text md:flex-row"},gt={class:"text flex-1 text-[#403D39]"},wt={class:"w-full md:w-auto"},bt={class:"flex flex-col px-3 py-2 font-medium text-left text md:flex-row"},kt={class:"text flex-1 text-[#403D39]"},St={class:"flex flex-col px-3 py-2 font-medium text-left text md:flex-row"},$t={class:"text flex-1 text-[#403D39]"},Ot={class:"flex flex-col px-3 py-2 font-medium text-left text md:flex-row"},At={class:"text flex-1 text-[#403D39]"},It=t("div",{class:"flex flex-col px-3 py-2 font-medium text-left text md:flex-row"},[d(" 運費： "),t("span",{class:"text flex-1 text-[#403D39]"},"資料資料")],-1),Tt={class:"flex flex-col px-3 py-2 font-medium text-left text md:flex-row"},Ct={class:"text flex-1 text-[#403D39]"},Et={class:"px-4 py-2 font-medium text-left border border-[#DDBEA9] rounded text"},Mt={class:"text text-[#403D39]"},Bt={class:"relative flex items-center justify-center gap-4 after:absolute after:content after:h-[1px] after:w-full after:bg-[#FFE8D6] after:-top-4"},Nt={__name:"ShowOrderModal",props:{record:Object},setup(r){const o=r,c=y(!1),i=y({}),e=y({Addr:"",CreatedAt:"",DeliveryMethod:"",Phone:"",Recipient:"",PaymentMethod:"",DeliveryStage:"",Discounts:[],OrderRemark:""}),a=T(()=>{var p,u,_,m;return(m=(_=(u=(p=e.value)==null?void 0:p.OrderItem)==null?void 0:u[0])==null?void 0:_.Specs)!=null&&m[0]?e.value.OrderItem[0].Specs[0].Num:0}),l=async()=>{const p={ID:o.record.ID};try{await C(P,p,u=>{if(e.value={...u.Data},e.value.Discounts=e.value.Discounts.length===0?"未使用優惠券":e.value.Discounts[0].Amount,e.value.OrderItem&&e.value.OrderItem.length>0){const _=e.value.OrderItem[0].GoodsID;i.value=JSON.parse(localStorage.getItem("goodsInfo")).find(m=>m.ID===_)}})}catch(u){E("訂單資料取得失敗",u)}},g=async()=>{c.value=!c.value,await l()},w=()=>{c.value=!c.value};return(p,u)=>{const _=F;return x(),f(D,null,[t("button",{type:"button",class:"text py-1.5 px-3 rounded-md shadow-md bg-[#FFE8D6] hover:bg-[#DDBEA9] transition-colors duration-150 text-[#252422] hover:text-white",onClick:g}," 詳細資料 "),v(N,{modelValue:s(c),"onUpdate:modelValue":u[0]||(u[0]=m=>B(c)?c.value=m:null)},{title:h(()=>[W]),content:h(()=>{var m,S,$,O,A;return[t("div",X,[t("div",Z,[tt,t("div",et,[t("img",{src:(($=(S=(m=s(i))==null?void 0:m.ImageUrls)==null?void 0:S[0])==null?void 0:$.Url)||s(U),alt:"",class:"h-[100px] max-w-[200px] object-cover"},null,8,st),t("div",ot,[t("h4",at,n((O=s(i))==null?void 0:O.Name),1),t("p",lt,n((A=s(i))==null?void 0:A.UnitPrice),1),t("span",nt,n(s(a)),1)])])]),t("div",rt,[ct,t("div",dt,[t("div",it,[t("div",xt,[t("div",ft,[d(" 訂購人： "),t("span",ut,n(s(e).Recipient),1)]),t("div",mt,[d(" 收件人： "),t("span",pt,n(s(e).Recipient),1)]),t("div",_t,[d(" 收件地址： "),t("span",ht,n(s(e).Addr),1)]),t("div",yt,[d(" 聯絡電話： "),t("span",vt,n(s(e).Phone),1)]),t("div",Dt,[d(" 訂單成立時間： "),t("span",gt,n(s(Q)(s(e).CreatedAt)),1)])]),t("div",wt,[t("div",bt,[d(" 配送方式： "),t("span",kt,n(s(e).DeliveryMethod),1)]),t("div",St,[d(" 訂單狀態： "),t("span",$t,n(s(e).DeliveryStage),1)]),t("div",Ot,[d(" 支付方式： "),t("span",At,n(s(e).PaymentMethod),1)]),It,t("div",Tt,[d(" 優惠劵： "),t("span",Ct,n(s(e).Discounts),1)])])])]),t("div",Et,[d(" 備註： "),t("span",Mt,n(s(e).OrderRemark),1)])])])]}),footer:h(()=>[t("div",Bt,[v(_,{onClick:w},{default:h(()=>[d("確定")]),_:1})])]),_:1},8,["modelValue"])],64)}}},Ft={class:"p-0 overflow-hidden md:p-8 lg:p-12"},Pt=t("h2",{class:"titleText text-2xl relative pl-3 after:content-[''] after:absolute after:bottom-0 after:left-0 after:top-0 after:border-2 after:border-[#DDBEA9]"}," 訂單查詢 ",-1),Rt={key:0,class:"mt-5 flex flex-col gap-3 items-center justify-center w-full h-full min-h-[200px] text text text-xl"},jt={key:1,class:"relative min-h-[calc(100vh-5rem)] mt-5"},Vt={class:"absolute top-0 bottom-0 w-full space-y-6 overflow-y-auto"},qt={__name:"order",setup(r){const o=y([]),c=y([{key:"ID",label:"訂單編號"},{key:"CheckoutAt",label:"訂單日期"},{key:"OrderStage",label:"狀態"},{key:"DeliveryStage",label:"寄送日期"},{key:"DeliveryMethod",label:"寄送方式"}]),i=async()=>{const e={};try{await C(V,e,a=>{o.value=[...a.Data],o.value.forEach(l=>{l.OrderStage=l.OrderStage==="0"?"未出貨":"已出貨",l.DeliveryStage=l.DeliveryStage==="0"?"":l.DeliveryStage,l.CheckoutAt=K(l.CheckoutAt)})})}catch(a){E("訂單資訊取得失敗",a)}};return R(async()=>{await i()}),(e,a)=>{const l=j("RouterLink"),g=Nt,w=J;return x(),f("div",Ft,[Pt,s(o).length===0?(x(),f("div",Rt,[d(" 還沒有購買商品，趕快去選購吧 "),v(l,{to:"/",class:"px-3 py-1 rounded-md link bg-[#FFE8D6]"},{default:h(()=>[d(" GO ")]),_:1})])):(x(),f("div",jt,[t("div",Vt,[v(w,{columns:s(c),data:s(o),emptyText:"當前沒有訂單資料"},{actions:h(({record:p})=>[v(g,{record:p},null,8,["record"])]),_:1},8,["columns","data"])])]))])}}};export{qt as default};
